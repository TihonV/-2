<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SuperBuilder - –ö–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä —Å–∞–π—Ç–æ–≤</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #4361ee;
            --secondary: #3f37c9;
            --accent: #4cc9f0;
            --light: #f8f9fa;
            --dark: #212529;
            --success: #4ade80;
            --warning: #facc15;
            --danger: #f87171;
            --gray: #6c757d;
            --border: #dee2e6;
            --shadow: 0 4px 6px -1px rgba(0,0,0,0.1);
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
            overflow: hidden;
        }

        .app-container {
            display: flex;
            height: 100vh;
            position: relative;
        }

        /* –ü–∞–Ω–µ–ª—å –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ */
        .toolbar {
            width: 80px;
            background: var(--dark);
            color: white;
            padding: 20px 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            box-shadow: var(--shadow);
            z-index: 100;
        }

        .tool-btn {
            width: 50px;
            height: 50px;
            border-radius: 12px;
            background: rgba(255,255,255,0.1);
            border: none;
            color: white;
            margin: 8px 0;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
        }

        .tool-btn:hover {
            background: var(--primary);
            transform: translateY(-2px);
        }

        .tool-btn.active {
            background: var(--accent);
        }

        /* –ë–æ–∫–æ–≤–∞—è –ø–∞–Ω–µ–ª—å */
        .sidebar {
            width: 300px;
            background: white;
            border-right: 1px solid var(--border);
            display: flex;
            flex-direction: column;
            transform: translateX(0);
            transition: transform 0.3s;
            z-index: 90;
        }

        .sidebar.collapsed {
            transform: translateX(-300px);
        }

        .sidebar-header {
            padding: 20px;
            border-bottom: 1px solid var(--border);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .sidebar-content {
            flex: 1;
            overflow-y: auto;
            padding: 15px;
        }

        .component-list {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
        }

        .component-item {
            padding: 15px;
            border: 2px dashed var(--border);
            border-radius: 8px;
            text-align: center;
            cursor: grab;
            transition: all 0.2s;
            background: #f8fafc;
        }

        .component-item:hover {
            border-color: var(--primary);
            background: #eff6ff;
        }

        /* –†–∞–±–æ—á–∞—è –æ–±–ª–∞—Å—Ç—å */
        .canvas-container {
            flex: 1;
            position: relative;
            overflow: auto;
            background: #e2e8f0;
        }

        .canvas {
            min-height: 100%;
            background: white;
            margin: 20px;
            border-radius: 12px;
            box-shadow: var(--shadow);
            position: relative;
        }

        .canvas-grid {
            background-image: 
                linear-gradient(rgba(0,0,0,0.05) 1px, transparent 1px),
                linear-gradient(90deg, rgba(0,0,0,0.05) 1px, transparent 1px);
            background-size: 20px 20px;
        }

        .element {
            position: absolute;
            min-width: 100px;
            min-height: 50px;
            border: 2px solid transparent;
            outline: 1px dashed rgba(67, 97, 238, 0.3);
            transition: all 0.2s;
            user-select: none;
        }

        .element.selected {
            border: 2px solid var(--primary);
            outline: none;
            box-shadow: 0 0 0 2px rgba(67, 97, 238, 0.2);
        }

        .element .resize-handle {
            position: absolute;
            width: 8px;
            height: 8px;
            background: var(--primary);
            border-radius: 50%;
        }

        .element .resize-handle-se {
            bottom: -4px;
            right: -4px;
            cursor: se-resize;
        }

        /* –ü–∞–Ω–µ–ª—å —Å–≤–æ–π—Å—Ç–≤ */
        .properties-panel {
            width: 300px;
            background: white;
            border-left: 1px solid var(--border);
            padding: 20px;
            overflow-y: auto;
        }

        .property-group {
            margin-bottom: 20px;
        }

        .property-group h4 {
            margin-bottom: 12px;
            color: var(--dark);
            border-bottom: 1px solid var(--border);
            padding-bottom: 8px;
        }

        .form-group {
            margin-bottom: 15px;
        }

        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: 500;
            color: var(--gray);
        }

        .form-control {
            width: 100%;
            padding: 8px 12px;
            border: 1px solid var(--border);
            border-radius: 6px;
            font-size: 14px;
        }

        .color-picker {
            height: 40px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
        }

        /* –ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è */
        .top-bar {
            position: fixed;
            top: 0;
            left: 80px;
            right: 0;
            height: 60px;
            background: white;
            border-bottom: 1px solid var(--border);
            display: flex;
            align-items: center;
            padding: 0 20px;
            z-index: 80;
        }

        .action-btn {
            padding: 8px 16px;
            margin: 0 5px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.2s;
        }

        .btn-primary {
            background: var(--primary);
            color: white;
        }

        .btn-success {
            background: var(--success);
            color: white;
        }

        .btn-danger {
            background: var(--danger);
            color: white;
        }

        .btn-outline {
            border: 1px solid var(--border);
            background: white;
        }

        /* –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s;
        }

        .modal.active {
            opacity: 1;
            pointer-events: all;
        }

        .modal-content {
            background: white;
            border-radius: 12px;
            width: 90%;
            max-width: 600px;
            max-height: 80vh;
            overflow-y: auto;
            transform: scale(0.9);
            transition: transform 0.3s;
        }

        .modal.active .modal-content {
            transform: scale(1);
        }

        .modal-header {
            padding: 20px;
            border-bottom: 1px solid var(--border);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-body {
            padding: 20px;
        }

        .modal-footer {
            padding: 20px;
            border-top: 1px solid var(--border);
            display: flex;
            justify-content: flex-end;
            gap: 10px;
        }

        /* –ê–Ω–∏–º–∞—Ü–∏–∏ */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .fade-in {
            animation: fadeIn 0.3s ease-out;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .app-container {
                flex-direction: column;
            }
            
            .toolbar {
                position: fixed;
                bottom: 0;
                width: 100%;
                height: 60px;
                flex-direction: row;
                justify-content: center;
            }
            
            .sidebar, .properties-panel {
                position: fixed;
                top: 60px;
                bottom: 60px;
                width: 100%;
                transform: translateX(100%);
            }
            
            .sidebar.active, .properties-panel.active {
                transform: translateX(0);
            }
            
            .canvas-container {
                margin-top: 60px;
                margin-bottom: 60px;
            }
            
            .top-bar {
                left: 0;
            }
        }
    </style>
</head>
<body>
    <div class="app-container">
        <!-- –ü–∞–Ω–µ–ª—å –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ -->
        <div class="toolbar">
            <button class="tool-btn active" title="–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã" data-panel="components">üì¶</button>
            <button class="tool-btn" title="–°–≤–æ–π—Å—Ç–≤–∞" data-panel="properties">‚öôÔ∏è</button>
            <button class="tool-btn" title="–®–∞–±–ª–æ–Ω—ã" data-panel="templates">üìã</button>
            <button class="tool-btn" title="–≠–∫—Å–ø–æ—Ä—Ç" onclick="showExportModal()">üì§</button>
            <button class="tool-btn" title="–ü–æ–º–æ—â—å" onclick="showHelpModal()">‚ùì</button>
        </div>

        <!-- –ë–æ–∫–æ–≤–∞—è –ø–∞–Ω–µ–ª—å -->
        <div class="sidebar">
            <div class="sidebar-header">
                <h3>–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã</h3>
                <button class="tool-btn" onclick="toggleSidebar()">‚úï</button>
            </div>
            <div class="sidebar-content">
                <div class="component-list">
                    <div class="component-item" draggable="true" data-type="text">
                        <span>üìÑ</span>
                        <div>–¢–µ–∫—Å—Ç</div>
                    </div>
                    <div class="component-item" draggable="true" data-type="image">
                        <span>üñºÔ∏è</span>
                        <div>–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ</div>
                    </div>
                    <div class="component-item" draggable="true" data-type="button">
                        <span>üîò</span>
                        <div>–ö–Ω–æ–ø–∫–∞</div>
                    </div>
                    <div class="component-item" draggable="true" data-type="input">
                        <span>‚úçÔ∏è</span>
                        <div>–ü–æ–ª–µ –≤–≤–æ–¥–∞</div>
                    </div>
                    <div class="component-item" draggable="true" data-type="card">
                        <span>üÉè</span>
                        <div>–ö–∞—Ä—Ç–æ—á–∫–∞</div>
                    </div>
                    <div class="component-item" draggable="true" data-type="grid">
                        <span>üåê</span>
                        <div>–°–µ—Ç–∫–∞</div>
                    </div>
                    <div class="component-item" draggable="true" data-type="video">
                        <span>üé•</span>
                        <div>–í–∏–¥–µ–æ</div>
                    </div>
                    <div class="component-item" draggable="true" data-type="map">
                        <span>üó∫Ô∏è</span>
                        <div>–ö–∞—Ä—Ç–∞</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- –†–∞–±–æ—á–∞—è –æ–±–ª–∞—Å—Ç—å -->
        <div class="canvas-container">
            <div class="canvas canvas-grid" id="canvas">
                <!-- –≠–ª–µ–º–µ–Ω—Ç—ã –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª—è—Ç—å—Å—è —Å—é–¥–∞ -->
                <div class="element" style="top: 100px; left: 100px; width: 200px; height: 100px;" onclick="selectElement(this)">
                    <div style="padding: 15px; color: var(--dark);">–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ SuperBuilder!</div>
                </div>
            </div>
        </div>

        <!-- –ü–∞–Ω–µ–ª—å —Å–≤–æ–π—Å—Ç–≤ -->
        <div class="properties-panel">
            <h3>–°–≤–æ–π—Å—Ç–≤–∞ —ç–ª–µ–º–µ–Ω—Ç–∞</h3>
            <div class="property-group">
                <h4>–ü–æ–∑–∏—Ü–∏—è –∏ —Ä–∞–∑–º–µ—Ä</h4>
                <div class="form-group">
                    <label>X</label>
                    <input type="number" class="form-control" id="posX" onchange="updateElementPosition()">
                </div>
                <div class="form-group">
                    <label>Y</label>
                    <input type="number" class="form-control" id="posY" onchange="updateElementPosition()">
                </div>
                <div class="form-group">
                    <label>–®–∏—Ä–∏–Ω–∞</label>
                    <input type="number" class="form-control" id="width" onchange="updateElementSize()">
                </div>
                <div class="form-group">
                    <label>–í—ã—Å–æ—Ç–∞</label>
                    <input type="number" class="form-control" id="height" onchange="updateElementSize()">
                </div>
            </div>
            <div class="property-group">
                <h4>–°—Ç–∏–ª–∏</h4>
                <div class="form-group">
                    <label>–¶–≤–µ—Ç —Ñ–æ–Ω–∞</label>
                    <input type="color" class="form-control color-picker" id="bgColor" onchange="updateElementStyle()">
                </div>
                <div class="form-group">
                    <label>–¶–≤–µ—Ç —Ç–µ–∫—Å—Ç–∞</label>
                    <input type="color" class="form-control color-picker" id="textColor" onchange="updateElementStyle()">
                </div>
                <div class="form-group">
                    <label>–†–∞–¥–∏—É—Å —Å–∫—Ä—É–≥–ª–µ–Ω–∏—è</label>
                    <input type="range" class="form-control" id="borderRadius" min="0" max="50" onchange="updateElementStyle()">
                </div>
            </div>
        </div>
    </div>

    <!-- –ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–≤–µ—Ä—Ö—É -->
    <div class="top-bar">
        <h2 style="margin-right: auto; color: var(--dark);">SuperBuilder</h2>
        <button class="action-btn btn-primary" onclick="saveProject()">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
        <button class="action-btn btn-success" onclick="previewSite()">–ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä</button>
        <button class="action-btn btn-outline" onclick="clearCanvas()">–û—á–∏—Å—Ç–∏—Ç—å</button>
        <button class="action-btn btn-danger" onclick="exportHTML()">–≠–∫—Å–ø–æ—Ä—Ç HTML</button>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —ç–∫—Å–ø–æ—Ä—Ç–∞ -->
    <div class="modal" id="exportModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>–≠–∫—Å–ø–æ—Ä—Ç –ø—Ä–æ–µ–∫—Ç–∞</h3>
                <button onclick="hideModal('exportModal')" class="tool-btn">√ó</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label>–ù–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞</label>
                    <input type="text" class="form-control" id="projectName" value="–ú–æ–π —Å–∞–π—Ç">
                </div>
                <div class="form-group">
                    <label>–¢–∏–ø —ç–∫—Å–ø–æ—Ä—Ç–∞</label>
                    <select class="form-control" id="exportType">
                        <option value="html">HTML —Ñ–∞–π–ª</option>
                        <option value="zip">ZIP –∞—Ä—Ö–∏–≤</option>
                        <option value="github">GitHub Repository</option>
                    </select>
                </div>
            </div>
            <div class="modal-footer">
                <button class="action-btn btn-outline" onclick="hideModal('exportModal')">–û—Ç–º–µ–Ω–∞</button>
                <button class="action-btn btn-primary" onclick="performExport()">–≠–∫—Å–ø–æ—Ä—Ç</button>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ø–æ–º–æ—â–∏ -->
    <div class="modal" id="helpModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>–ü–æ–º–æ—â—å –ø–æ SuperBuilder</h3>
                <button onclick="hideModal('helpModal')" class="tool-btn">√ó</button>
            </div>
            <div class="modal-body">
                <h4>–ì–æ—Ä—è—á–∏–µ –∫–ª–∞–≤–∏—à–∏:</h4>
                <ul style="margin: 10px 0; padding-left: 20px;">
                    <li><strong>Ctrl+S</strong> - –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –ø—Ä–æ–µ–∫—Ç</li>
                    <li><strong>Ctrl+Z</strong> - –û—Ç–º–µ–Ω–∏—Ç—å –¥–µ–π—Å—Ç–≤–∏–µ</li>
                    <li><strong>Del</strong> - –£–¥–∞–ª–∏—Ç—å —ç–ª–µ–º–µ–Ω—Ç</li>
                    <li><strong>Ctrl+C/V</strong> - –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å/–í—Å—Ç–∞–≤–∏—Ç—å</li>
                </ul>
                <h4>–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:</h4>
                <ul style="margin: 10px 0; padding-left: 20px;">
                    <li>Drag & Drop –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å</li>
                    <li>–†–µ–∞–ª—å–Ω—ã–π CSS —Ä–µ–¥–∞–∫—Ç–æ—Ä</li>
                    <li>–≠–∫—Å–ø–æ—Ä—Ç –≤ HTML/CSS/JS</li>
                    <li>–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ localStorage</li>
                    <li>–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å GitHub API</li>
                </ul>
            </div>
            <div class="modal-footer">
                <button class="action-btn btn-primary" onclick="hideModal('helpModal')">–ü–æ–Ω—è—Ç–Ω–æ</button>
            </div>
        </div>
    </div>

    <script>
        // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
        let selectedElement = null;
        let isDragging = false;
        let dragOffset = { x: 0, y: 0 };
        let history = [];
        let historyIndex = -1;

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        document.addEventListener('DOMContentLoaded', function() {
            setupEventListeners();
            loadProject();
        });

        function setupEventListeners() {
            // –ü–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
            document.querySelectorAll('.component-item').forEach(item => {
                item.addEventListener('dragstart', handleDragStart);
            });

            // –†–∞–±–æ—á–∞—è –æ–±–ª–∞—Å—Ç—å
            const canvas = document.getElementById('canvas');
            canvas.addEventListener('dragover', handleDragOver);
            canvas.addEventListener('drop', handleDrop);
            canvas.addEventListener('click', handleClickOutside);

            // –ö–ª–∞–≤–∏—à–∏
            document.addEventListener('keydown', handleKeyPress);
        }

        function handleDragStart(e) {
            e.dataTransfer.setData('text/plain', e.target.dataset.type);
        }

        function handleDragOver(e) {
            e.preventDefault();
        }

        function handleDrop(e) {
            e.preventDefault();
            const type = e.dataTransfer.getData('text/plain');
            createElement(type, e.clientX, e.clientY);
        }

        function createElement(type, x, y) {
            const canvas = document.getElementById('canvas');
            const rect = canvas.getBoundingClientRect();
            
            const element = document.createElement('div');
            element.className = 'element';
            element.style.position = 'absolute';
            element.style.left = (x - rect.left - 50) + 'px';
            element.style.top = (y - rect.top - 25) + 'px';
            element.style.width = '200px';
            element.style.height = '100px';
            element.onclick = () => selectElement(element);

            let content = '';
            switch(type) {
                case 'text':
                    content = '<div style="padding: 15px; color: var(--dark);">–¢–µ–∫—Å—Ç–æ–≤—ã–π –±–ª–æ–∫</div>';
                    break;
                case 'image':
                    content = '<img src="https://via.placeholder.com/200x100" style="width: 100%; height: 100%; object-fit: cover;">';
                    break;
                case 'button':
                    content = '<button style="width: 100%; height: 100%; border: none; background: var(--primary); color: white; cursor: pointer;">–ö–Ω–æ–ø–∫–∞</button>';
                    break;
                case 'input':
                    content = '<input type="text" placeholder="–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç..." style="width: 100%; height: 100%; padding: 15px; border: 1px solid var(--border); border-radius: 6px;">';
                    break;
                case 'card':
                    content = `
                        <div style="padding: 15px; border: 1px solid var(--border); border-radius: 8px; height: 100%;">
                            <h4>–ö–∞—Ä—Ç–æ—á–∫–∞</h4>
                            <p>–û–ø–∏—Å–∞–Ω–∏–µ –∫–∞—Ä—Ç–æ—á–∫–∏</p>
                        </div>
                    `;
                    break;
                case 'grid':
                    content = `
                        <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px; padding: 10px; height: 100%;">
                            <div style="background: #f0f0f0; padding: 10px;">–Ø—á–µ–π–∫–∞ 1</div>
                            <div style="background: #f0f0f0; padding: 10px;">–Ø—á–µ–π–∫–∞ 2</div>
                        </div>
                    `;
                    break;
                case 'video':
                    content = '<video controls style="width: 100%; height: 100%; object-fit: cover;"><source src="" type="video/mp4"></video>';
                    break;
                case 'map':
                    content = '<div style="background: #e0e0e0; padding: 20px; text-align: center; height: 100%;">–ö–∞—Ä—Ç–∞</div>';
                    break;
            }

            element.innerHTML = content;
            canvas.appendChild(element);
            selectElement(element);
            saveToHistory();
        }

        function selectElement(element) {
            // –°–Ω—è—Ç—å –≤—ã–¥–µ–ª–µ–Ω–∏–µ —Å –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞
            if (selectedElement) {
                selectedElement.classList.remove('selected');
            }
            
            // –í—ã–¥–µ–ª–∏—Ç—å –Ω–æ–≤—ã–π —ç–ª–µ–º–µ–Ω—Ç
            element.classList.add('selected');
            selectedElement = element;

            // –ó–∞–ø–æ–ª–Ω–∏—Ç—å –ø–∞–Ω–µ–ª—å —Å–≤–æ–π—Å—Ç–≤
            updatePropertiesPanel();
        }

        function updatePropertiesPanel() {
            if (!selectedElement) return;

            const rect = selectedElement.getBoundingClientRect();
            const canvasRect = document.getElementById('canvas').getBoundingClientRect();

            document.getElementById('posX').value = Math.round(rect.left - canvasRect.left);
            document.getElementById('posY').value = Math.round(rect.top - canvasRect.top);
            document.getElementById('width').value = Math.round(rect.width);
            document.getElementById('height').value = Math.round(rect.height);
            
            // –¶–≤–µ—Ç–∞
            const styles = window.getComputedStyle(selectedElement);
            document.getElementById('bgColor').value = rgbToHex(styles.backgroundColor);
            document.getElementById('textColor').value = rgbToHex(styles.color);
            document.getElementById('borderRadius').value = parseInt(styles.borderRadius) || 0;
        }

        function updateElementPosition() {
            if (!selectedElement) return;
            
            const x = document.getElementById('posX').value;
            const y = document.getElementById('posY').value;
            
            selectedElement.style.left = x + 'px';
            selectedElement.style.top = y + 'px';
        }

        function updateElementSize() {
            if (!selectedElement) return;
            
            const width = document.getElementById('width').value;
            const height = document.getElementById('height').value;
            
            selectedElement.style.width = width + 'px';
            selectedElement.style.height = height + 'px';
        }

        function updateElementStyle() {
            if (!selectedElement) return;
            
            const bgColor = document.getElementById('bgColor').value;
            const textColor = document.getElementById('textColor').value;
            const borderRadius = document.getElementById('borderRadius').value;
            
            selectedElement.style.backgroundColor = bgColor;
            selectedElement.style.color = textColor;
            selectedElement.style.borderRadius = borderRadius + 'px';
        }

        function handleClickOutside(e) {
            if (e.target === document.getElementById('canvas')) {
                if (selectedElement) {
                    selectedElement.classList.remove('selected');
                    selectedElement = null;
                    clearPropertiesPanel();
                }
            }
        }

        function clearPropertiesPanel() {
            document.getElementById('posX').value = '';
            document.getElementById('posY').value = '';
            document.getElementById('width').value = '';
            document.getElementById('height').value = '';
        }

        function handleKeyPress(e) {
            // –£–¥–∞–ª–µ–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç–∞ (Delete)
            if (e.key === 'Delete' && selectedElement) {
                selectedElement.remove();
                selectedElement = null;
                saveToHistory();
            }
            
            // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ (Ctrl+S)
            if (e.ctrlKey && e.key === 's') {
                e.preventDefault();
                saveProject();
            }
            
            // –û—Ç–º–µ–Ω–∞ (Ctrl+Z)
            if (e.ctrlKey && e.key === 'z') {
                e.preventDefault();
                undoAction();
            }
        }

        function saveToHistory() {
            const canvasHTML = document.getElementById('canvas').innerHTML;
            history.push(canvasHTML);
            historyIndex = history.length - 1;
        }

        function undoAction() {
            if (historyIndex > 0) {
                historyIndex--;
                document.getElementById('canvas').innerHTML = history[historyIndex] || '';
                selectedElement = null;
            }
        }

        function saveProject() {
            const projectData = {
                canvas: document.getElementById('canvas').innerHTML,
                timestamp: new Date().toISOString()
            };
            localStorage.setItem('superbuilder_project', JSON.stringify(projectData));
            showMessage('–ü—Ä–æ–µ–∫—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω!', 'success');
        }

        function loadProject() {
            const saved = localStorage.getItem('superbuilder_project');
            if (saved) {
                const projectData = JSON.parse(saved);
                document.getElementById('canvas').innerHTML = projectData.canvas;
                showMessage('–ü—Ä–æ–µ–∫—Ç –∑–∞–≥—Ä—É–∂–µ–Ω!', 'info');
            }
        }

        function clearCanvas() {
            if (confirm('–û—á–∏—Å—Ç–∏—Ç—å –≤—Å—é —Ä–∞–±–æ—á—É—é –æ–±–ª–∞—Å—Ç—å?')) {
                document.getElementById('canvas').innerHTML = '';
                selectedElement = null;
                saveToHistory();
            }
        }

        function previewSite() {
            const canvas = document.getElementById('canvas');
            const previewWindow = window.open('', '_blank');
            
            previewWindow.document.write(`
                <!DOCTYPE html>
                <html>
                <head>
                    <title>–ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä —Å–∞–π—Ç–∞</title>
                    <style>
                        body { margin: 0; padding: 20px; font-family: Arial, sans-serif; }
                        .canvas { max-width: 1200px; margin: 0 auto; }
                    </style>
                </head>
                <body>
                    <div class="canvas">
                        ${canvas.innerHTML}
                    </div>
                </body>
                </html>
            `);
        }

        function exportHTML() {
            showExportModal();
        }

        function showExportModal() {
            document.getElementById('exportModal').classList.add('active');
        }

        function showHelpModal() {
            document.getElementById('helpModal').classList.add('active');
        }

        function hideModal(modalId) {
            document.getElementById(modalId).classList.remove('active');
        }

        function performExport() {
            const projectName = document.getElementById('projectName').value;
            const exportType = document.getElementById('exportType').value;
            
            if (exportType === 'html') {
                const htmlContent = generateHTML();
                downloadFile(`${projectName}.html`, htmlContent);
            } else if (exportType === 'zip') {
                // –õ–æ–≥–∏–∫–∞ –¥–ª—è ZIP –∞—Ä—Ö–∏–≤–∞
                showMessage('ZIP —ç–∫—Å–ø–æ—Ä—Ç –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ', 'warning');
            } else if (exportType === 'github') {
                // –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å GitHub API
                exportToGitHub(projectName);
            }
            
            hideModal('exportModal');
        }

        function generateHTML() {
            const canvasContent = document.getElementById('canvas').innerHTML;
            return `
<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–≠–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Å–∞–π—Ç</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: Arial, sans-serif; }
        .canvas { padding: 20px; }
        .element { position: relative; margin: 10px 0; }
    </style>
</head>
<body>
    <div class="canvas">
        ${canvasContent}
    </div>
</body>
</html>
            `;
        }

        function downloadFile(filename, content) {
            const blob = new Blob([content], { type: 'text/html' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = filename;
            a.click();
            URL.revokeObjectURL(url);
        }

        async function exportToGitHub(projectName) {
            try {
                // –ó–¥–µ—Å—å –±—É–¥–µ—Ç –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å GitHub API
                // –¢—Ä–µ–±—É–µ—Ç—Å—è OAuth –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
                showMessage('–≠–∫—Å–ø–æ—Ä—Ç –≤ GitHub —Ç—Ä–µ–±—É–µ—Ç –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏', 'info');
                
                // –ü—Ä–∏–º–µ—Ä —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–ª—è GitHub API
                const githubData = {
                    owner: '–≤–∞—à-–ª–æ–≥–∏–Ω',
                    repo: projectName,
                    path: 'index.html',
                    message: 'Add website from SuperBuilder',
                    content: btoa(unescape(encodeURIComponent(generateHTML())))
                };
                
                // fetch –∑–∞–ø—Ä–æ—Å –∫ GitHub API
                // await fetch(`https://api.github.com/repos/${githubData.owner}/${githubData.repo}/contents/${githubData.path}`, {
                //     method: 'PUT',
                //     headers: {
                //         'Authorization': 'token YOUR_TOKEN',
                //         'Accept': 'application/vnd.github.v3+json'
                //     },
                //     body: JSON.stringify(githubData)
                // });
                
            } catch (error) {
                showMessage('–û—à–∏–±–∫–∞ —ç–∫—Å–ø–æ—Ä—Ç–∞ –≤ GitHub: ' + error.message, 'error');
            }
        }

        function showMessage(text, type = 'info') {
            const message = document.createElement('div');
            message.textContent = text;
            message.style.cssText = `
                position: fixed;
                top: 70px;
                right: 20px;
                padding: 12px 20px;
                border-radius: 6px;
                color: white;
                font-weight: 500;
                z-index: 1000;
                animation: fadeIn 0.3s;
            `;
            
            const colors = {
                success: '#4ade80',
                error: '#f87171',
                warning: '#fbbf24',
                info: '#60a5fa'
            };
            
            message.style.background = colors[type] || colors.info;
            
            document.body.appendChild(message);
            
            setTimeout(() => {
                message.remove();
            }, 3000);
        }

        function toggleSidebar() {
            document.querySelector('.sidebar').classList.toggle('collapsed');
        }

        function rgbToHex(rgb) {
            if (!rgb || rgb === 'transparent') return '#ffffff';
            if (rgb.startsWith('#')) return rgb;
            
            const match = rgb.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/);
            if (!match) return '#ffffff';
            
            return '#' + [match[1], match[2], match[3]].map(x => {
                const hex = parseInt(x).toString(16);
                return hex.length === 1 ? '0' + hex : hex;
            }).join('');
        }

        // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã—Ö –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π
        function addAdvancedFeatures() {
            // –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∞–Ω–∏–º–∞—Ü–∏–π
            // –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –º–µ–¥–∏–∞ –∑–∞–ø—Ä–æ—Å–æ–≤
            // –ü–æ–¥–¥–µ—Ä–∂–∫–∞ CSS Grid/Flexbox
            // –ü–æ–¥–¥–µ—Ä–∂–∫–∞ JavaScript —Å–æ–±—ã—Ç–∏–π
            // –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –≤–Ω–µ—à–Ω–∏–º–∏ API
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã—Ö –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π
        addAdvancedFeatures();
    </script>
</body>
</html>
