<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SuperBuilder by Tihon Metelkin</title>
    <style>
        :root {
            --primary: #6366f1;
            --accent: #ec4899;
            --dark: #1e293b;
            --light: #f9fafb;
            --border: #e5e7eb;
            --shadow: 0 10px 25px -5px rgba(0,0,0,0.1);
            --glass: rgba(255,255,255,0.1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', sans-serif;
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
            color: white;
            min-height: 100vh;
            overflow: hidden;
        }

        /* –ó–∞–≥–æ–ª–æ–≤–æ–∫ –∞–≤—Ç–æ—Ä—Å—Ç–≤–∞ */
        .author {
            position: fixed;
            bottom: 10px;
            right: 10px;
            font-size: 12px;
            color: rgba(255,255,255,0.5);
            z-index: 1000;
            pointer-events: none;
        }

        .app-container {
            display: flex;
            height: 100vh;
        }

        /* –õ–µ–≤–∞—è –ø–∞–Ω–µ–ª—å */
        .sidebar {
            width: 280px;
            background: rgba(15, 23, 42, 0.9);
            backdrop-filter: blur(10px);
            border-right: 1px solid rgba(255,255,255,0.1);
            padding: 20px;
            overflow-y: auto;
        }

        .sidebar h3 {
            margin-bottom: 15px;
            color: var(--light);
        }

        .component-item {
            padding: 15px;
            background: rgba(30, 41, 59, 0.5);
            border-radius: 12px;
            margin-bottom: 10px;
            cursor: grab;
            transition: all 0.2s;
            border: 2px dashed transparent;
        }

        .component-item:hover {
            background: var(--primary);
            transform: translateY(-2px);
            border-color: white;
        }

        /* –•–æ–ª—Å—Ç */
        .canvas-container {
            flex: 1;
            padding: 20px;
            overflow: auto;
            position: relative;
        }

        .canvas {
            min-height: 100%;
            min-width: 100%;
            background: url('https://assets.website-files.com/60f9f1e5d716fc7ed536831f/6100c235a571269a33657643_grid.svg');
            border-radius: 12px;
            position: relative;
        }

        .element {
            position: absolute;
            min-width: 100px;
            min-height: 50px;
            background: white;
            color: black;
            border-radius: 8px;
            padding: 10px;
            cursor: move;
            user-select: none;
            box-shadow: var(--shadow);
        }

        /* –ü–∞–Ω–µ–ª—å —Å–≤–æ–π—Å—Ç–≤ */
        .properties {
            width: 280px;
            background: rgba(15, 23, 42, 0.9);
            backdrop-filter: blur(10px);
            border-left: 1px solid rgba(255,255,255,0.1);
            padding: 20px;
            overflow-y: auto;
        }

        .form-group {
            margin-bottom: 15px;
        }

        .form-group label {
            display: block;
            margin-bottom: 5px;
            color: var(--light);
        }

        .form-control {
            width: 100%;
            padding: 8px 12px;
            border: 1px solid var(--border);
            border-radius: 6px;
            background: rgba(30, 41, 59, 0.5);
            color: white;
        }

        button, input[type="file"] {
            cursor: pointer;
        }

        /* –ö–Ω–æ–ø–∫–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è */
        .toolbar {
            position: fixed;
            top: 20px;
            left: 20px;
            z-index: 100;
            display: flex;
            gap: 10px;
        }

        .btn {
            padding: 10px 16px;
            border: none;
            border-radius: 6px;
            background: var(--primary);
            color: white;
            cursor: pointer;
            font-weight: 500;
        }

        .btn:hover {
            opacity: 0.9;
        }
    </style>
</head>
<body>

<div class="toolbar">
    <button class="btn" onclick="saveProject()">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
    <button class="btn" onclick="loadProject()">üì• –ó–∞–≥—Ä—É–∑–∏—Ç—å</button>
    <button class="btn" onclick="clearCanvas()">üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å</button>
</div>

<div class="app-container">
    <!-- –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã -->
    <div class="sidebar">
        <h3>–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã</h3>
        <div class="component-item" draggable="true" ondragstart="dragStart(event, 'text')">üìù –¢–µ–∫—Å—Ç</div>
        <div class="component-item" draggable="true" ondragstart="dragStart(event, 'image')">üñºÔ∏è –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ</div>
        <div class="component-item" draggable="true" ondragstart="dragStart(event, 'button')">üîò –ö–Ω–æ–ø–∫–∞</div>
        <div class="component-item" draggable="true" ondragstart="dragStart(event, 'video')">üé• –í–∏–¥–µ–æ</div>
        <div class="component-item" draggable="true" ondragstart="dragStart(event, 'card')">üÉè –ö–∞—Ä—Ç–æ—á–∫–∞</div>
    </div>

    <!-- –•–æ–ª—Å—Ç -->
    <div class="canvas-container">
        <div class="canvas" id="canvas" ondrop="drop(event)" ondragover="allowDrop(event)"></div>
    </div>

    <!-- –°–≤–æ–π—Å—Ç–≤–∞ -->
    <div class="properties">
        <h3>–°–≤–æ–π—Å—Ç–≤–∞</h3>
        <div id="property-panel">
            –í—ã–±–µ—Ä–∏—Ç–µ —ç–ª–µ–º–µ–Ω—Ç
        </div>
    </div>
</div>

<!-- –ê–≤—Ç–æ—Ä—Å—Ç–≤–æ -->
<div class="author">¬© 2025 Tihon Metelkin ‚Äî SuperBuilder AI</div>

<script>
    let draggedType = null;
    let selectedElement = null;

    // --- DRAG & DROP ---
    function allowDrop(e) {
        e.preventDefault();
    }

    function dragStart(e, type) {
        draggedType = type;
        e.dataTransfer.setData("text/plain", type);
    }

    function drop(e) {
        e.preventDefault();
        const type = draggedType;
        const rect = document.getElementById('canvas').getBoundingClientRect();
        const x = e.clientX - rect.left;
        const y = e.clientY - rect.top;

        createElement(type, x, y);
    }

    // --- –°–û–ó–î–ê–ù–ò–ï –≠–õ–ï–ú–ï–ù–¢–û–í ---
    function createElement(type, x, y) {
        const el = document.createElement('div');
        el.className = 'element';
        el.style.left = x + 'px';
        el.style.top = y + 'px';
        el.draggable = true;
        el.onclick = () => selectElement(el);

        switch (type) {
            case 'text':
                el.innerHTML = '<input type="text" value="–¢–µ–∫—Å—Ç" style="width:100%; border:none; background:transparent;" />';
                break;
            case 'image':
                el.innerHTML = `
                    <input type="text" placeholder="URL –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è" oninput="updateImage(this)" style="width:100%; margin-bottom:5px;" />
                    <input type="file" accept="image/*" onchange="uploadImage(this)" style="width:100%;" />
                    <img src="" id="img-preview" style="max-width:100%; max-height:150px; margin-top:5px;" />
                `;
                break;
            case 'button':
                el.innerHTML = `
                    <input type="text" value="–ö–Ω–æ–ø–∫–∞" style="width:100%; border:none; text-align:center; background:transparent;" /><br>
                    <input type="text" placeholder="–°—Å—ã–ª–∫–∞" id="btn-link" style="width:100%; margin:5px 0;" />
                    <select id="btn-target" style="width:100%;">
                        <option value="_self">–í —Ç–µ–∫—É—â–µ–π –≤–∫–ª–∞–¥–∫–µ</option>
                        <option value="_blank">–í –Ω–æ–≤–æ–π –≤–∫–ª–∞–¥–∫–µ</option>
                        <option value="newPage">–ù–æ–≤–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞</option>
                    </select>
                `;
                el.oninput = updateButtonLogic;
                break;
            case 'video':
                el.innerHTML = `
                    <input type="text" placeholder="URL –≤–∏–¥–µ–æ" oninput="updateVideo(this)" style="width:100%; margin-bottom:5px;" />
                    <input type="file" accept="video/*" onchange="uploadVideo(this)" style="width:100%;" />
                    <video controls style="width:100%; max-height:200px; margin-top:5px;"></video>
                `;
                break;
            case 'card':
                el.innerHTML = `
                    <h4>–ö–∞—Ä—Ç–æ—á–∫–∞</h4>
                    <p>–û–ø–∏—Å–∞–Ω–∏–µ</p>
                    <button onclick="alert('–ö–Ω–æ–ø–∫–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç!')">–î–µ–π—Å—Ç–≤–∏–µ</button>
                `;
                break;
        }

        document.getElementById('canvas').appendChild(el);
        selectElement(el);
    }

    // --- –†–ê–ë–û–¢–ê –° –ò–ó–û–ë–†–ê–ñ–ï–ù–ò–Ø–ú–ò ---
    function uploadImage(input) {
        if (input.files && input.files[0]) {
            const reader = new FileReader();
            reader.onload = function(e) {
                const img = input.parentNode.querySelector('#img-preview');
                const urlInput = input.parentNode.querySelector('input[type="text"]');
                img.src = e.target.result;
                urlInput.value = e.target.result;
                updateImage(urlInput);
            };
            reader.readAsDataURL(input.files[0]);
        }
    }

    function updateImage(input) {
        const img = input.parentNode.querySelector('#img-preview');
        img.src = input.value;
    }

    // --- –†–ê–ë–û–¢–ê –° –í–ò–î–ï–û ---
    function uploadVideo(input) {
        if (input.files && input.files[0]) {
            const reader = new FileReader();
            reader.onload = function(e) {
                const video = input.parentNode.querySelector('video');
                const urlInput = input.parentNode.querySelector('input[type="text"]');
                video.src = e.target.result;
                urlInput.value = e.target.result;
            };
            reader.readAsDataURL(input.files[0]);
        }
    }

    function updateVideo(input) {
        const video = input.parentNode.querySelector('video');
        video.src = input.value;
    }

    // --- –õ–û–ì–ò–ö–ê –ö–ù–û–ü–ö–ò ---
    function updateButtonLogic() {
        const container = this.parentNode;
        const link = container.querySelector('#btn-link').value;
        const target = container.querySelector('#btn-target').value;

        container.onclick = function(e) {
            if (e.target.tagName === 'INPUT' || e.target.tagName === 'SELECT') return;
            
            if (target === 'newPage') {
                alert(`–ü–µ—Ä–µ—Ö–æ–¥ –Ω–∞ –Ω–æ–≤—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É: ${link || 'home'}`);
                // –ó–¥–µ—Å—å –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å —Å–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã
            } else if (link) {
                window.open(link, target);
            }
        };
    }

    // --- –í–´–î–ï–õ–ï–ù–ò–ï –≠–õ–ï–ú–ï–ù–¢–ê ---
    function selectElement(el) {
        if (selectedElement) {
            selectedElement.style.outline = 'none';
        }
        selectedElement = el;
        el.style.outline = '3px solid #6366f1';

        showProperties(el);
    }

    // --- –ü–ê–ù–ï–õ–¨ –°–í–û–ô–°–¢–í ---
    function showProperties(el) {
        const panel = document.getElementById('property-panel');
        const rect = el.getBoundingClientRect();

        panel.innerHTML = `
            <div class="form-group">
                <label>X: ${Math.round(rect.left)}</label>
                <input type="range" min="0" max="1200" value="${Math.round(rect.left)}" oninput="moveElement(this, 'x')">
            </div>
            <div class="form-group">
                <label>Y: ${Math.round(rect.top)}</label>
                <input type="range" min="0" max="800" value="${Math.round(rect.top)}" oninput="moveElement(this, 'y')">
            </div>
            <div class="form-group">
                <label>–§–æ–Ω (URL)</label>
                <input type="text" placeholder="URL —Ñ–æ–Ω–∞" oninput="setBackground(this)" value="${el.style.backgroundImage || ''}" style="background-image: ${el.style.backgroundImage}">
            </div>
            <div class="form-group">
                <label>–¶–≤–µ—Ç —Ç–µ–∫—Å—Ç–∞</label>
                <input type="color" oninput="setTextColor(this)" value="#000000">
            </div>
        `;

        // –ï—Å–ª–∏ —ç—Ç–æ –∫–Ω–æ–ø–∫–∞ ‚Äî –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Å–≤–æ–π—Å—Ç–≤–∞
        if (el.innerHTML.includes('–°—Å—ã–ª–∫–∞')) {
            panel.innerHTML += `
                <div class="form-group">
                    <label>–¢–µ–∫—Å—Ç –∫–Ω–æ–ø–∫–∏</label>
                    <input type="text" value="${el.querySelector('input[type="text"]').value}" oninput="updateButtonText(this)">
                </div>
            `;
        }
    }

    function moveElement(input, axis) {
        if (!selectedElement) return;
        const value = input.value;
        if (axis === 'x') selectedElement.style.left = value + 'px';
        if (axis === 'y') selectedElement.style.top = value + 'px';
        showProperties(selectedElement); // –û–±–Ω–æ–≤–ª—è–µ–º –ø–æ–ª–æ–∂–µ–Ω–∏–µ
    }

    function setBackground(input) {
        if (!selectedElement) return;
        const url = input.value;
        selectedElement.style.backgroundImage = url ? `url(${url})` : 'none';
        selectedElement.style.backgroundSize = 'cover';
        selectedElement.style.backgroundPosition = 'center';
    }

    function setTextColor(input) {
        if (!selectedElement) return;
        selectedElement.style.color = input.value;
    }

    function updateButtonText(input) {
        if (!selectedElement) return;
        selectedElement.querySelector('input[type="text"]').value = input.value;
    }

    // --- –°–û–•–†–ê–ù–ï–ù–ò–ï –ò –ó–ê–ì–†–£–ó–ö–ê ---
    function saveProject() {
        const canvas = document.getElementById('canvas');
        localStorage.setItem('superbuilder_project', canvas.innerHTML);
        showMessage('‚úÖ –ü—Ä–æ–µ–∫—Ç —Å–æ—Ö—Ä–∞–Ω—ë–Ω');
    }

    function loadProject() {
        const saved = localStorage.getItem('superbuilder_project');
        if (saved) {
            document.getElementById('canvas').innerHTML = saved;
            // –ü–µ—Ä–µ–ø—Ä–∏–≤—è–∑—ã–≤–∞–µ–º —Å–æ–±—ã—Ç–∏—è
            document.querySelectorAll('.element').forEach(el => {
                el.onclick = () => selectElement(el);
                if (el.innerHTML.includes('–°—Å—ã–ª–∫–∞')) {
                    el.oninput = updateButtonLogic;
                }
            });
            showMessage('üì• –ü—Ä–æ–µ–∫—Ç –∑–∞–≥—Ä—É–∂–µ–Ω');
        } else {
            showMessage('‚ùå –ù–µ—Ç —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤');
        }
    }

    function clearCanvas() {
        if (confirm('–û—á–∏—Å—Ç–∏—Ç—å –≤—Å—ë?')) {
            document.getElementById('canvas').innerHTML = '';
            selectedElement = null;
            document.getElementById('property-panel').innerHTML = '–•–æ–ª—Å—Ç –ø—É—Å—Ç';
        }
    }

    // --- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è ---
    function showMessage(text) {
        const msg = document.createElement('div');
        msg.textContent = text;
        msg.style.cssText = `
            position: fixed; top: 70px; right: 20px; padding: 12px 20px;
            background: #10b981; color: white; border-radius: 6px; z-index: 1000;
            animation: fadeIn 0.3s, fadeOut 0.3s 2.7s forwards;
        `;
        document.body.appendChild(msg);
        setTimeout(() => document.body.removeChild(msg), 3000);
    }

    // –ê–Ω–∏–º–∞—Ü–∏—è –¥–ª—è —Å–æ–æ–±—â–µ–Ω–∏–π
    const style = document.createElement('style');
    style.textContent = `
        @keyframes fadeIn { from { opacity: 0; transform: translateY(-10px); } to { opacity: 1; } }
        @keyframes fadeOut { from { opacity: 1; } to { opacity: 0; transform: translateY(-10px); } }
    `;
    document.head.appendChild(style);
</script>

</body>
</html>
